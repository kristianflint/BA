\documentclass[11pt,a4paper]{article} 
\usepackage[danish]{babel}
\usepackage[utf8]{inputenc}

\begin{document}

\section{Forside}

\section{Problemformulering}



\section{Indledning}


\section{Intruduktion}
Før jeg gik igang med dette projekt lagde jeg sjælden mærke til skyggeren i et rum. Selv om vi ikke ligger ret meget mærke til skygger ville verden se helt anderledes ud uden. Derfor er det også umuligt at lave en grafisk realistisk gengivelse af virkeligheden på en computer uden at på en eller anden måde at ligge skygger på.

\section{Hårde skygger}
Beskriver forskellige måder at ligge hårde skygger på en scene. De 2 metoder der i dag bruges til at ligge.

shadow maps
stencil shadow volumes

\section{Shadowmap}

Shadow maps blev indreduceret i 1987 af Lance Williams i artiklen "Casting curved shadows on curved surfaces". Siden er teknikken blevet brugt i film og computer grafik til at skyggelægge objekter.

Shadow mapping algoritmen arbejder kun i billedopløsninger og stiller derfor ingen særlige krav scenen anden end at den skal kunne tegens, dette gør at algoritmen meget fleksibel i forhold til valg af grafiske primitivere.


\subsection{Teori}

En intuative måde at finde ud af om et punkt er i skygge eller ej er forstille sig at man tegner en lige linje fra lyskildes origon til punktet A. Hvis denne linje rammer et eller flere punkter før den når punktet A, vil A være i  skygge ellers ikke. Dette kan ses på FIGUR1.

[figur1]
bla. bla.

Det er netop denne tanke gang og en dybte buffer som shadow mapping udnytter. At skulle tegne linjer fra lyskilden til hvert punkt vil blive en meget kostelig affære, og det er her dybte bufferen bliver udnyttet. For når en 3D scenen projekteres til 2D billede, ses netop alle de alle punkter der er synlige fra kameraet, og hvis kameraet er i samme punkt som lyset vil disse også være de punkter der er synlige fra lyskilden. (Disse punkter og deres dybder gemmes i en dybde buffer beregnet til dette og kan senere bruges.)

Men dette i tankerne kan to steps algoritmen for shadow mapping nu beskrives således:

1. Scenen renderes set fra lyset men kun dybderne i scenen bliver gemt i dybde bufferen/ dybdekort.
2. kameraet flyttes til en anden position og scenen renderes. Hvert fragment projekteres over i dybde bufferen og de to z-værdier sammenlignes. Er z-værdien i dybde buffere mindre er fragmentet i skygge.

I step 1 er det kun dybder der er interessante og der kan derfor spares regne kraft på at udlade at rendere farver.

[FIGUR2] shadowmap teknikken


At kameraet bruges for at finde ud af hvad der er lyst op gør at denne metode egner sig godt ved brug af spot light som lys kilde, dette kan dog udvides til andre lyskilder som fx. punkt lyskilder. Denne opgave vil kun arbejde med spot light som lyskilder og i stedet fokusere på teknikker til at forbedre skyggerne der bliver kastet.  


\subsection{Praktisk}


Shadow mapping algoritmen er i teorien er meget simpel, men da dybde kortet er en diskret repræsentation af scene går at der kan opstå en del problemer med algoritmen. 

Et af de første problemer med shadow mapping der skal tages hånd om er clipping planerne i visningstuben (view frustum). Hvis alle objekter ikke ligger inden for "front"  og "back" clipping planerne vil disse fejlagtigt komme i skygge selv om de skulle være lyst op. se figur 3. Det er derfor vigtigt at sørge for at alle objekter ligger inden for disse 2 planer for at få et godt resultat. 


Disse problemer er:

1. numerisk unøjagtighed ved dybte sammen ligning.
2. geometrisk unøjagtighed.
3. Oversampling
4. Undersampling
5. Front og back clipping plan.



Problem 1 og 2 
 
 
 
\subsubsection{Shadow acne}

dybde buffer eller kort?

Når punkter fra kameraet projekteres ind i dybde kortet kan forskellige problemer opstå. Et problem er at decimaler smides væk fordi der dybde buffer indeholder flydende tal. Dybde buffer har et vis antal bit til at repræsentere det flydende tal for z-værdien,  og som altid når der bruges flyenden tal kan der opstår afrundings fejl. Denne afrundings fejl kan betyde at når de 2 z-værdier sammenlignes er disse ikke helt ens og fladen kan derfor fejlagtigt kaste skygge på sig selv. 

På figur S1 ses det hvorfor dette problem opstår når afrundings fejlen opstår.


Der er mange måder at løse/ afhjælpe shadow acne på:

Tætning af visningstuben
biasing
	sloap baising


Tætning af visningstuben

Som forklaret tidligere er problemet med shadow acne at der ikke er præcision nok i dybde kortet, denne præcision kan forbedres ved at rykke  "front"  og "back" clipping planerne så de tætter indkapsler alle objekterne i scenen. Denne opgave vil ikke forklare hvordan denne tætning opnås men blot forklare og vise at dette(OVERVEJ OM JEG OGSÅ VIL DET) vil give et bedre resultat. Tætning af visningstuben kan dog ikke afhjælpe alle de afrundings fejl der opstår når floating points for dybde-værdierne sammenlignes.

Biasing

Biasing er en er en måde at løse de sammenlignings fejl der er skyld i shadow acne. Metoden fungere ved at addere et lille offset til fragtmenter når scenen renderes fra lyset, dette bevirker at alle fragtmenter vil have en lidt mindre z-værdi end når scenen renderes for kameraet, og derved forsvinder shadow acne problemet. 

Biasing vil gerne opnå at dybde fra øjet(kameratet) =< dybde i shadowmappet for alle fragtmenter fra det samme polygonium.



I den simplste for er biasing en konstant offset værdi der tilføjes til fragtmentet

 





\subsubsection{Peter panning}


\subsection{Forbedringer/aliasing}

En anden grund til problemet opstår er fordi dybde bufferen ikke er lineær (er den kun for orthogonale projektion), dvs. største delen af presicitionen ligger tæt på "front clipping" planet. Dette betyder at jo længere væk objekterne er fra lyskilden jo mindre præcise vil skyggerne blive, dette bliver dog kun et problem hvis kameraet er tæt på disse objekter. 

Kigger på mulighederne for at forbedre shadow mapping teknikken vha. aliasing:

forskellige metoder:
Interpolated shadowing
Percentage Closer Filtering (PCF)
Variance Shadow Mapping (VSM)


\section{Stencil Shadow Volumes}

\subsection{Teori}
Beskrivelse af Stencil shadow Volumes teknikken. heriblandt fordele og ulemper.

løser problemet med 1-1 fra cam til lys

\subsection{Depth-Pass Vs. Depth-Fail}
Sammen ligner de 2 metoder Depth-Pass og Depth-Fail for at bestemme om en vertex er i skygge eller ej.


\section{Afprøvning}
 De 2 metoder afprøves, og det vises hvordan de forskellige metoder og filtre påvirker resultaterne.	

\subsection{Køretider}
Køretiderner for de 2 metoder afprøves.

\section{Konklution}



\end{document}